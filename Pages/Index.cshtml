@page
@model IndexModel
@{
    ViewData["Title"] = "Organigrama";
    Layout = "_Layout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/site.css">
}

<div class="app-container">
    <header class="app-header">
    </header>
    <main>
        <div class="org-container">

            <header class="page-header">
                <h1>Organigrama de TI</h1>
                <p class="lead-text">FIlrar por area o buscar por nombre de empleado.</p>
            </header>

            <div class="control-group">

                <div class="area-selector-module">
                    <select id="area-selector" class="area-selector-dropdown">
                        <option value="">Seleccione un Área para ver su Director</option>
                    </select>
                </div>

                <div class="search-module">
                    <input type="text" id="employee-search-input" placeholder="Buscar empleado por nombre o puesto...">
                    <button id="employee-search-button" class="btn-search">Buscar</button>
                    <span id="search-status" class="search-status-message"></span>
                </div>
                <div class="admin-actions" style="margin-left:12px; display:flex; align-items:center; gap:8px;">
                    <a asp-page="/ManageStructure" class="btn btn-outline-secondary">Editar estructura</a>
                </div>
            </div>
            <div id="org-view">
            </div>
        </div>

    </main>

    <div id="filterOverlay" class="filter-overlay" onclick="window.toggleFilterPanel()"></div>
</div>
<div id="custom-tooltip" class="custom-tooltip"></div>

@section Scripts {
    <script src="~/js/site.js"></script>
    <script>
        document.querySelectorAll('.profile-card-glass, .chief-card-premium').forEach(card => {
            card.addEventListener('mousemove', e => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                // Calcular rotación (máximo 10 grados)
                const centerX = rect.width / 2;
                const centerY = rect.height / 2;
                const rotateX = ((y - centerY) / centerY) * -10;
                const rotateY = ((x - centerX) / centerX) * 10;

                // Aplicar transformación
                card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;

                // Mover el brillo (Highlight)
                card.style.setProperty('--mouse-x', `${(x / rect.width) * 100}%`);
                card.style.setProperty('--mouse-y', `${(y / rect.height) * 100}%`);
            });

            card.addEventListener('mouseleave', () => {
                card.style.transform = `perspective(1000px) rotateX(0deg) rotateY(0deg)`;
            });
        });
    </script>
}